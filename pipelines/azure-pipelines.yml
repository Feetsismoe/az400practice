# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
  - main


pool:
  vmImage: ubuntu-latest

variables:
  - template: ./build_params.yml

steps:
- script: echo ${{ variables.Hello}}
  displayName: 'Run a one-line script'

- task: Docker@2
  displayName: Build an image
  inputs:
    command: buildAndPush
    containerRegistry: 'RomanStephan'
    repository: testrepo
    tags: python-docker

- task: AzureRmWebAppDeployment@4
  displayName: 'Azure App Service Deploy: container-test'
  inputs:
    azureSubscription: '8a36a3c4-cb97-4495-b09f-60ccd60c2eea'
    appType: webAppContainer
    WebAppName: 'stephanromantest'
    DockerNamespace: 'stephanromantest.azurecr.io'
    DockerRepository: testrepo
    DockerImageTag: 'python-docker'